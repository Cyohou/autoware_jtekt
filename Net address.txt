
pose.pose.orientation：四元数（EKF 使用 yaw；z/roll/pitch 进入 1D 滤波）								
pose.covariance：6×6（至少 X、Y、Yaw 方差准确）								
处理								
延迟补偿：stamp + pose_additional_delay → delay_step								
门控：马氏距离阈值 pose_gate_dist								
/localization/twist_estimator/twist_with_covariance								
类型：geometry_msgs/TwistWithCovarianceStamped								
必要字段								
header.frame_id：必须为 base_link								
header.stamp：测量时刻								
twist.twist.linear.x：vx								
twist.twist.angular.z：wz								
twist.covariance：6×6（至少 vx、wz 方差准确）								
处理								
延迟补偿：stamp + twist_additional_delay → delay_step								
门控：马氏距离阈值 twist_gate_dist								
工程落地与验证清单								
接线模式								
基线稳妥（推荐）								
软位姿：odometry.pose → pose_with_cov（协方差大）								
硬位姿：GNSS fix→pose_with_cov（协方差小，动态随 FIX/FLOAT/HDOP 调整）								
预测：odometry.twist → twist_with_cov								
极简高性能（GNSS 全程优）								
odometry.pose + odometry.twist 双高频输入，按 GNSS 质量动态调 pose 协方差								
仍建议保留硬锚定低频注入作为保险								
协方差与门控								
动态协方差（强烈建议）								
FIX：XY 方差小（例如 0.03–0.08 m 的平方级）								
FLOAT：中等								
单点/遮挡：大，必要时拒收								
创新/马氏距离门限								
超阈值拒收该帧，避免多路径/跳变污染								
延迟与时间								
pose_additional_delay/twist_additional_delay：补偿 0.1–0.3 s 常见 GNSS 延迟								
严格使用测量时间戳（非接收时间）								
超出 extend_state_step * dt 的延迟将被丢弃								
参考系与标定								
固定 map 原点（硬件 LRF，重启不变）								
准确的杆臂（lever arm）与 TF								
速度 frame 要求 base_link								
所有 pose 观测 frame_id 一致（= pose_frame_id）								
验证指标								
创新量/马氏距离：长期有界，无系统性偏移								
一致性：输出 pose 的时间微分 ≈ twist								
fix 到来时无大“抽回”								
瞬时退化后恢复快速、无残留偏差								
记录拒收率与延迟阶数，排查边界工况								
